---
title: "Exploration des données"
title-block-banner: false
description: | 
  Petite description de cette page.
# à changer
date: "2022-12-21"
# Modifier les détails que vous voulez
author:
  - name: "Prénom Nom"
    # Votre site web perso ou github
    url: https://github.com/VOTREUSERNAME
    # les champs d'affiliation sont optionnels, vous pouvez les
    # comment out en ajoutant un # devant.
    affiliation: FAS1002
    affiliation-url: https://FAS1002.github.io/A22
    # changer pour votre propre orcid id
    # https://orcid.org/ pour vous inscrire.
    orcid: 0000-0000-0000-0000

# TRUE == Générer une citation pour cette page précise. Pour enlever, mettre false.
citation: true
# Inclure les références que vous utilisez dans vos rapports. Je conseille Zotero pour construire
# ce fichier ou de connecter RStudio directement pour pouvoir citer avec @nom-de-reference.
bibliography: references.bib
---

## Un peu d'interactivité pour le plaisir!

```{r map}
library(leaflet)
leaflet() %>%
    setView(lng=150,
            lat=-30,
            zoom = 3) %>%
    addTiles() %>%
    addMarkers(lng=174.768,
               lat=-36.852,
               popup="Là où R est né") %>%
    addProviderTiles(providers$Esri.WorldGrayCanvas)
```

## Peut-être que ça vous inspirera!

```{r plotly, message=FALSE, warning=FALSE}
library(plotly)
library(gapminder)
df <- gapminder

fig <- df %>%
  plot_ly(
    x = ~ gdpPercap,
    y = ~ lifeExp,
    size = ~ pop,
    color = ~ continent,
    frame = ~ year,
    text = ~ country,
    hoverinfo = "text",
    type = 'scatter',
    mode = 'markers',
    width = "100%",
    height = 600
  )

fig <- fig %>% layout(xaxis = list(type = "log"))

fig <- fig %>%
  animation_button(
    x = 0, xanchor = "left", y = -0.15, yanchor = "bottom"
  )
fig
```

------------------------------------------------------------------------

```{r}
library(lubridate)
library(fs)
library(vtable)
library(ggplot2)
library(countrycode)
```

```{r}
source("helper.R")
data_co2 <- get_raw_data()
data_co2 <- data_co2 |> 
    mutate(continent = countrycode(sourcevar = data_co2$country,
                                   origin = "country.name",
                                   destination = "continent"))
```

## Statistiques

### Statistiques selon les continents

```{r}
 sumtable(data_co2,
         summ=c('mean(x)',
                'median(x)',
                'sd(x)',
                'max(x)',
                'min(x)'),
         vars= c('gdp',
                 'population',
                 'co2',
                 'co2_per_capita',
                 'co2_per_gdp',
                 'energy_per_capita',
                 'energy_per_gdp'),
         group="continent",
         title="Statistiques sommaires selon les continents") 
```

```{r}
knitr::include_graphics("figures/Rplot.png")
```

## Des graphiques

### Émissions de Co2 selon le pib par continent en 2016 et 1990

Il faut commencer par sélectionner la valeur 2016 de la variable "year'" dans notre ensemble de données afin de faire une analyse des émissions de Co2 selon le PIB par continent en 2016 précisemment.

```{r}
data_co2_2016 <- filter(data_co2, year == "2016")
```

```{r}
graphique_co2_pib <- ggplot(data=data_co2_2016, aes(x=gdp, y = co2_per_capita, color = continent)) +
    geom_point()+ scale_x_continuous(trans = "log10")+
    scale_y_continuous(trans = "log10") +
    labs(title = "Évolution des émissions de CO2 par PIB en fonction du PIB en 2016", x="PIB", y="CO2", caption = "Données tirées de World in Data") + theme_light()
graphique_co2_pib
```

Il faut sélectionner la valeur 1990 de la variable "year'" dans notre ensemble de données afin de faire une analyse des émissions de Co2 selon le PIB par continent en 1990 précisemment.

```{r}
data_co2_1990 <- filter(data_co2, year == "1990")
```

```{r}
graphique_co2_pib_1990 <- ggplot(data=data_co2_1990, aes(x=gdp, y = co2_per_capita, color = continent)) +
    geom_point()+ scale_x_continuous(trans = "log10")+
    scale_y_continuous(trans = "log10") +
    labs(title = "Évolution des émissions de CO2 par PIB en fonction du PIB en 1990", x="PIB", y="CO2", caption = "Données tirées de World in Data") + theme_light()
graphique_co2_pib_1990
```

### Densité de la population selon les émissions de CO2 par habitant par continent en 2016

```{r}
co2_2016 <- ggplot(data = data_co2_2016, aes(x = co2_per_capita, fill = continent)) +
    geom_density(position="stack") +
    theme_light() +
    labs(title = "2016", x="CO2 par habitant", y="Densité d'habitants", caption = "Données tirées de World in Data : Co2 and Greenhouse Gaz Emission")+
    scale_x_continuous(limits=c(0,25))
co2_2016
```

### 

### Évolution des émissions de CO2 depuis 1850 selon les différents continents

```{r}
graph_evol_co2 <- ggplot(data = data_co2, aes(x=year, y=co2)) +
    geom_line(aes(color=country),size = 1.2) + xlim(1850, 2020) +
    theme_light() +
    labs(color = "Pays") +
    labs(title = "Évolution des émissions de CO2 depuis 1850 selon les continents", x="Année", y="CO2")
graph_evol_co2 
```

### Évolution de la population depuis 1850 selon les différents continents

```{r}
graph_evol_pop <- ggplot(data = data_co2, aes(x=year, y=population)) +
    geom_line(aes(color=country),size = 1.2) + xlim(1850, 2020) +
    theme_light()+ labs(color = "Pays") +
    labs(title = " Évolution de la population depuis 1850 selon les continents", x="Année", y="Population",
         caption = "Données tirées de World in Data : Co2 and Greenhouse Gaz Emission")
graph_evol_pop
```

### Évolution de l'énergie selon le pib en 2016  et 1990 selon les différents continents

```{r}
graphique_ene_pib <- ggplot(data=data_co2_2016, aes(x=gdp, y = energy_per_capita, color = continent)) +
    geom_point()+ scale_x_continuous(trans = "log10")+
    scale_y_continuous(trans = "log10") +
    labs(title = "Évolution de l'énergie par PIB en fonction du PIB en 2016", x="PIB", y="Energy", caption = "Données tirées de World in Data : CO2 and Greenhouse Gaz Emissions") + theme_light()
graphique_ene_pib
```

```{r}
graphique_ene_pib_1990 <- ggplot(data=data_co2_1990, aes(x=gdp, y = energy_per_capita, color = continent)) +
    geom_point()+ scale_x_continuous(trans = "log10")+
    scale_y_continuous(trans = "log10") +
    labs(title = "Évolution de l'énergie par PIB en fonction du PIB en 1990", x="PIB", y="CO2", caption = "Données tirées de World in Data : CO2 and Greenhouse Gaz Emissions") + theme_light()
graphique_ene_pib_1990
```

### Évolution de l'espérance de vie moyenne selon les continents à travers le temps

```{r}
graph <- sheet_gapminder |> 
    group_by(continent,
             year) |> 
    summarise(mean = mean(`Life expectancy`, na.rm = T))

life_expectancy <- ggplot(data = graph, aes(x = as.numeric(year), y = mean, color = continent)) +
    geom_line(stat = "identity") +
    scale_x_continuous(n.breaks = 12) +
    scale_color_discrete(name = "Continents",
                         labels = c("Afrique",
                                    "Amériques",
                                    "Asie",
                                    "Europe",
                                    "Océanie")) +
    theme_bw() + 
    labs(title = "Évolution de l'espérance de vie par continent",
         source = "https://ourworldindata.org/co2-and-other-greenhouse-gas-emissions",
         x = " ",
         y = " ")

life_expectancy
```
